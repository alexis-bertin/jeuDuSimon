<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" type="image/png" href="img/icon-36x36.png" />

    <title>JEU DU SIMON - TP4</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet">
    <link href="vendor/devicons/css/devicons.min.css" rel="stylesheet">
    <link href="vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="tools/audiosynth.js"></script>

    <!-- Custom styles for this template -->
    <link href="css/resume.min.css" rel="stylesheet">

  </head>

  <body id="page-top">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">
        <span class="d-block d-lg-none">JEU DU SIMON</span>
        <span class="d-none d-lg-block">
          <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="img/simon.jpg" alt="">
        </span>
      </a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#about">Accueil</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#experience">Règles</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#education">Jeu</a>
          </li>
         
        </ul>
      </div>
    </nav>

    <div class="container-fluid p-0">

      <section class="resume-section p-3 p-lg-5 d-flex d-column" id="about">
        <div class="my-auto">
          <h1 class="mb-1">Jeu du Simon
            <span class="text-primary"></span>
          </h1>
          <div class="subheading mb-3">Alexis Bertin & Adrien Penven 
          </div>
          <p class="mb-5">Bienvenue sur notre site sur lequel vous pouvez jouer au jeu du Simon ! <br/>
          	TP n° 4 - Vendredi 15 décembre 2017
          </p>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <div class="subheading mb-3">Ressources</div>
              <p>Langages : HTML/CSS, Javascript et JQUERY</p>
              <p>Audio : <a href="http://keithwhor.github.io/audiosynth/" target="_blank">Keithwhor</a></p>
              <p>Test : <a href="https://codepen.io/rlemon/pen/JAmyn" target="_blank">Codepen.io</a></p>
              <p>Aide : <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript" target="_blank">Mdn Web docs</a></p>
            </div>
            
          </div>
          
        </div>
      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column" id="experience">
        <div class="my-auto">
          <h2 class="mb-4">Règles du jeu :</h2>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <div class="subheading mb-3">Objectif</div>
              <p>Répéter la séquence de touches lumineuses affichées par le jeu du Simon.</p>

            </div>
            
          </div>

          <div class="resume-item d-flex flex-column flex-md-row mb-5">
            <div class="resume-content mr-auto">
              <div class="subheading mb-3">Principe</div>
              <p>Le jeu du Simon affiche aléatoirement une séquence de touches lumineuses, produisant simultanément des sons associés à ces touches. Retenez bien la séquence ! C’est ensuite à vous, joueur, de reproduire la séquence pour augmenter votre score.</p>
            </div>
           
          </div>


          <div class="resume-item d-flex flex-column flex-md-row">
            <div class="resume-content mr-auto">
              <h3 class="mb-0"></h3>
              <div class="subheading mb-3">Sources</div>
              <p> Règles officielles : <a href="http://www.ludotheque-ajaccio.fr/jeux/regles/supersimon.pdf" target="_blank">supersimon.pdf</a>, <a href="https://fr.wikipedia.org/wiki/Simon_(jeu)" target="_blank">Wikipédia</a>.</p>

            </div>
           
          </div>

        </div>

      </section>

      <section class="resume-section p-3 p-lg-5 d-flex flex-column" id="education">
        <div class="my-auto">
          <h2 class="mb-4">JEU DU SIMON :</h2><p class="subheading mb-5">Cliquez sur "JOUER" afin de commencer une partie !</p>

         <table id="formulss">
  <tr id="forms">
  <td id="forms">
  <p class="subheading mb-4">Choisir le nombre de notes :</p>
  <select name="notes" id="notes" onchange="changerNbNotes();">
     <option value="3">3</option>
     <option value="4">4</option>
     <option value="5">5</option>
     <option value="6">6</option>
     <option value="7">7</option>
     <option value="8">8</option>
  </select>
  </td>
  <td id="forms">
  <p class="subheading mb-4">Choisir la vitesse initiale :</p>
  <select name="vitesse" id="vitesse" onchange="changerVitesse();">
     <option value="facile">Facile</option>
     <option value="moyen" selected="selected">Moyen</option>
     <option value="difficile">Difficile</option>
  </select>
  </td>
  </tr>
  </table>
  <div id="boutons">
    <table>
    <tr>
      <td><div id="bouton1"><div id="note1">La4</div></div></br></td>
      <td><div id="bouton2"><div id="note2">Si4</div></div></br></td>
      <td><div id="bouton3"><div id="note3">Do4</div></div></br></td>
      <td><div id="bouton4"><div id="note4">R&eacute;4</div></div></br></td>
      <td><div id="bouton5"><div id="note5">Mi4</div></div></br></td>
      <td><div id="bouton6"><div id="note6">Fa4</div></div></br></td>
      <td><div id="bouton7"><div id="note7">Sol4</div></div></br></td>
      <td><div id="bouton8"><div id="note8">La3</div></div></br></td>
    </tr>
    </table>
  </div></br>
  <div class="subheading mb-4" id="win">Vous avez gagn&eacute; !</div>
  <div id="loose" class="subheading mb-4">Score : </div>
  <div class="subheading mb-4" id="elbouton"><button id="start"> Jouer </button></div>
  <div class="subheading mb-4" id="stop"><button id="arreter" onclick="document.location.reload(false)"> Arrêter le jeu </button></div>
  <div class="subheading mb-4" id="lebouton"><button id="restart" onClick="document.location.reload(false)"> Rejouer </button></div>
  <script type="text/javascript">
			$(function(){
			   $('#start').click(function(){
			      	$('#elbouton').toggle(); 
			      	$( "#stop" ).toggle();
			      	var select2 = document.getElementById("vitesse");
					var valeur2 = select2.options[select2.selectedIndex].value;
					if (valeur2 == "facile") {
						commencer1(valeur2);
					}
					else if (valeur2 == "moyen") {
						commencer2(valeur2);
					}
					else if (valeur2 == "difficile") {
						commencer3(valeur2);
					}
			   });
			});

			function commencer1(y) {
				var select = document.getElementById("notes");
				var valeur = select.options[select.selectedIndex].value;
				var valeur2 = y;
				var vit1 = 800;
				var vit2 = 1000;
				demarrer(valeur,vit1,vit2);
			}

			function commencer2(y) {
				var select = document.getElementById("notes");
				var valeur = select.options[select.selectedIndex].value;
				var valeur2 = y;
				var vit1 = 600;
				var vit2 = 800;
				demarrer(valeur,vit1,vit2);
			}

			function commencer3(y) {
				var select = document.getElementById("notes");
				var valeur = select.options[select.selectedIndex].value;
				var valeur2 = y;
				var vit1 = 400;
				var vit2 = 600;
				demarrer(valeur,vit1,vit2);
			}

			

//////////////////////////////////////////////////////////////////////////////////////////////////////////////
			
			

			var tour = 1;
			var tab1 = new Array();
			var round = 0;
			var i = 0;
			var tab2 = new Array(); 
								var vit1 = 800;
					var vit2 = 1000;


			function demarrer(x,v1,v2) {
				$( "#bouton1" ).unbind("mousedown");
				$( "#bouton2" ).unbind("mousedown");
				$( "#bouton3" ).unbind("mousedown");
				$( "#bouton4" ).unbind("mousedown");
				$( "#bouton5" ).unbind("mousedown");
				$( "#bouton6" ).unbind("mousedown");
				$( "#bouton7" ).unbind("mousedown");
				$( "#bouton8" ).unbind("mousedown");
				var vit1 = v1;
				var vit2 = v2;
				tab2.splice(0, 100);
				var i = 0;
				document.getElementById("formulss").style.display = "none";
				tab1[tour-1] = Math.floor((x)*Math.random()+1); 
				console.log(tab1);
				var piano = Synth.createInstrument('piano');
				lapstime = setInterval(function() {
					allumage = setInterval(function() {	
						console.log(tab1[i]);
						if (tab1[i] == 1) {
							piano.play('A', 4, 1);
					  		$("#bouton1").css('background-color', '#FB6666');
					  		$('#note1').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
					  		clearInterval(allumage);
						}
						else if (tab1[i] == 2) {
							piano.play('B', 4, 1);
							$("#bouton2").css('background-color', '#8473FB');
							$('#note2').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
							clearInterval(allumage);
						}
						else if (tab1[i] == 3) {
							piano.play('C', 4, 1);
					  		$("#bouton3").css('background-color', '#5CD55C');
					  		$('#note3').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
					  		clearInterval(allumage);
						}
						else if (tab1[i] == 4) {
							piano.play('D', 4, 1);
							$("#bouton4").css('background-color', '#F2F5A9');
							$('#note4').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
							clearInterval(allumage);
						}
						else if (tab1[i] == 5) {
							piano.play('E', 4, 1);
					  		$("#bouton5").css('background-color', '#FBEFF2');
					  		$('#note5').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
					  		clearInterval(allumage);
						}
						else if (tab1[i] == 6) {
							piano.play('F', 4, 1);
							$("#bouton6").css('background-color', '#E2A9F3');
							$('#note6').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
							clearInterval(allumage);
						}
						else if (tab1[i] == 7) {
							piano.play('G', 4, 1);
					  		$("#bouton7").css('background-color', '#D7DF01');
					  		$('#note7').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
					  		clearInterval(allumage);
						}
						else if (tab1[i] == 8) {
							piano.play('A', 3, 1);
					  		$("#bouton8").css('background-color', '#DF3A01');
					  		$('#note8').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
					  		clearInterval(allumage);
						}
						var toutour = tour - 1;
						if (i == toutour) {
							clearInterval(allumage);
						}
						i += 1 ;
					}, vit1);
					$("#bouton8").css('background-color', 'maroon');
					$("#bouton7").css('background-color', 'olive');
					$("#bouton6").css('background-color', 'purple');
					$("#bouton5").css('background-color', 'pink');
					$("#bouton4").css('background-color', 'yellow');
					$("#bouton3").css('background-color', 'green');
					$("#bouton2").css('background-color', 'blue');
					$("#bouton1").css('background-color', 'red');
					var toutour = tour - 1;
					if (i == toutour) {
						console.log("true");
						clearInterval(lapstime);
						var attente = vit1+vit2;
						setTimeout(function() {
						    animationClic(vit1,vit2);
						    $("#bouton8").css('background-color', 'maroon');
							$("#bouton7").css('background-color', 'olive');
							$("#bouton6").css('background-color', 'purple');
							$("#bouton5").css('background-color', 'pink');
							$("#bouton4").css('background-color', 'yellow');
							$("#bouton3").css('background-color', 'green');
							$("#bouton2").css('background-color', 'blue');
							$("#bouton1").css('background-color', 'red');
						}, attente)
					}
					else {console.log("false");}
				}, vit2)
			}
			


			function comparerTableaux(tab1, tab2, v1, v2) {
				var vit1 = v1;
				var vit2 = v2;
				var select = document.getElementById("notes");
				var valeur = select.options[select.selectedIndex].value;
				console.log("Comparaison !");
				for (var i = 0; i < tab2.length; i++) {
					console.log("Valeur de i : "+i);
					console.log("Valeur de tab1 : "+tab1[i]);
					console.log("Valeur de tab2 : "+tab2[i]);
					if (tab1[i] != tab2[i]) {
						$('#lebouton').toggle();
						$( "#stop" ).toggle();
						document.getElementById('bouton1').style.display = 'none';
						document.getElementById('bouton2').style.display = 'none';
						document.getElementById('bouton3').style.display = 'none';
						document.getElementById('bouton4').style.display = 'none';
						document.getElementById('bouton5').style.display = 'none';
						document.getElementById('bouton6').style.display = 'none';
						document.getElementById('bouton7').style.display = 'none';
						document.getElementById('bouton8').style.display = 'none';
						var skoll = tour-1;
						$("#loose").text('Score : ' + skoll).toggle();
					}
					else if (tab1.length == tab2.length && tab1[tab1.length-1] == tab2[tab2.length-1]) {
						console.log("Valeur de tour : "+ tour)
						round = 0;
						tour += 1;
						var vit = vit1 + vit2;
						console.log("Vitesse : "+vit);
						vit1 -= (vit1*10)/100;
						vit2 -= (vit2*10)/100;
						i = 0;
						console.log("C'est bon !");
						demarrer(valeur,vit1,vit2);
					}
					else if (tab1[i] == tab2[i]) {
						console.log("Nouveau round !");
						animationClic(vit1, vit2);
					}
				}
				return;
			}	

			function animationClic(v1, v2) {
				var vit1 = v1;
				var vit2 = v2;
				console.log("Début tour !");
				var piano = Synth.createInstrument('piano');
				$("#bouton1").mousedown(function(event) {
					console.log(tab2);
					tab2.push(1);
				  	piano.play('A', 4, 1);
				  	$('#note1').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#FB6666');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'red');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton2").mousedown(function(event) {
					console.log(tab2);
					tab2.push(2);		
				  	piano.play('B', 4, 1);
				  	$('#note2').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#8473FB');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'blue');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton3").mousedown(function(event) {
					console.log(tab2);
					tab2.push(3);
					
				  	piano.play('C', 4, 1);
				  	$('#note3').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#5CD55C');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'green');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton4").mousedown(function(event) {
					console.log(tab2);
					tab2.push(4);
					
				  	piano.play('D', 4, 1);
				  	$('#note4').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#F2F5A9');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'yellow');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton5").mousedown(function(event) {
					console.log(tab2);
					tab2.push(5);
					
				  	piano.play('E', 4, 1);
				  	$('#note5').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#FBEFF2');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'pink');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton6").mousedown(function(event) {
					console.log(tab2);
					tab2.push(6);
					
				  	piano.play('F', 4, 1);
				  	$('#note6').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#E2A9F3');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'purple');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton7").mousedown(function(event) {
					console.log(tab2);
					tab2.push(7);
					
				  	piano.play('G', 4, 1);
				  	$('#note7').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#D7DF01');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'olive');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
				$("#bouton8").mousedown(function(event) {
					console.log(tab2);
					tab2.push(8);
					
				  	piano.play('A', 3, 1);
				  	$('#note8').fadeToggle( 200, "linear" ).delay(200).fadeOut( 200 );
				  	$(this).css('background-color', '#DF3A01');
				  	$(this).mouseup(function() {
					  	$(this).css('background-color', 'maroon');
					});
					console.log(tab2);
					comparerTableaux(tab1, tab2, vit1, vit2);
					event.stopImmediatePropagation();
				});
			}



/////////////////////////////////////////////////////////////////////////////////////////////////////////////



			
			//Séquence lue plus vite <--> nombre de notes
			//Nombres de notes (score) affiché lorsqu'on perd
		
		function changerNbNotes() {
			//récupère valeur du formulaire
			var select = document.getElementById("notes");
			var valeur = select.options[select.selectedIndex].value;
			console.log(valeur);
			//change le nombre de notes
			document.getElementById('bouton4').style.display = 'none';
			document.getElementById('bouton5').style.display = 'none';
			document.getElementById('bouton6').style.display = 'none';
			document.getElementById('bouton7').style.display = 'none';
			document.getElementById('bouton8').style.display = 'none';
			for (var i = 0; i < valeur-3; i++) {
				var zbeub = i + 4;
				$( "#bouton"+zbeub ).toggle(); 
			}
		}

		function changerVitesse() {
			var select = document.getElementById("vitesse");
			var valeur = select.options[select.selectedIndex].value;
			console.log(valeur);
		}


  </script>

        </div>
      </section>

     
    </div>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/resume.min.js"></script>

  </body>

</html>
